{"title":"我是如何发表博客的","date":"2022-07-11T23:32:02.000Z","date_formatted":{"ll":"Jul 11, 2022","L":"07/11/2022","MM-DD":"07-11"},"thumbnail":"https://img.xiangnorth.com/2022/07/VfTLVg.jpg","color":"#111","link":"how-i-publish-blog","comments":true,"tags":["Blog","GitHub Actions","Vercel"],"categories":["Coding Sheet"],"updated":"2022-07-13T00:15:45.336Z","content":"<h2 id=\"prologue\">Prologue<a title=\"#prologue\" href=\"#prologue\"></a></h2>\n<h3 id=\"lofter\">Lofter<a title=\"#lofter\" href=\"#lofter\"></a></h3>\n<p>在 2014 年，我在 <a href=\"https://lofter.com/\" target=\"_blank\">Lofter</a> 开始了一段时间的博客写作生活，也成为了上面的首批用户。</p>\n<p><img src=\"https://img.xiangnorth.com/2022/07/TKtK6U.png\" alt=\"Lofter\" loading=\"lazy\" class=\"φbp\"></p>\n<p>有幸被 <a href=\"https://web.archive.org/web/20190315110511/http://yishuabear.lofter.com/\" target=\"_blank\">Wayback Manchine</a> 收录了一张快照。</p>\n<p>那时刚接触 Android，也就是我人生的<strong>第一台属于自己的安卓手机</strong>——「中兴 U793」。在研究刷机，学习 ROM 制作的时候，我发现了 <a href=\"https://xda-developers.com/\" target=\"_blank\">XDA Developers</a>。</p>\n<p>于是出于兴趣开始陆续搬运上面的相关文章。</p>\n<h3 id=\"wordpress\">WordPress<a title=\"#wordpress\" href=\"#wordpress\"></a></h3>\n<p><img src=\"https://img.xiangnorth.com/2022/07/tSsLNN.png\" alt=\"WordPress\" loading=\"lazy\" class=\"φbp\"></p>\n<p>大名鼎鼎的 <a href=\"https://wordpress.com/\" target=\"_blank\">WordPress</a>，是我<strong>第一个</strong>个人网站的框架。</p>\n<p>一句题外话，依稀记得当初 WordPress 中文官网被墙，英文官网能访问的魔幻现实。</p>\n<p>由于当时经济能力限制，我曾辗转 <a href=\"https://www.hostinger.com/\" target=\"_blank\">Hostinger</a>，<a href=\"https://www.000webhost.com\" target=\"_blank\">000webhost</a>，以及国内各种杂七杂八的免费空间（什么「彩虹云」、「七朵云」、「千云」等等），当然这也直接导致了我众多密码的泄露，导致现在社工库里能有一连串密码</p>\n<p>我也同时从 <a href=\"https://freenom.com/\" target=\"_blank\">freenom</a> 注册了<s>不止</s>一个免费域名。途中注册的波折也是我接触到「科学上网」的起源，至今仍记得当时凌晨在网吧，死活加载不出 CAPTCHA 的痛苦。</p>\n<p>在网站搭建中，我也开始接触到 <code>PHP</code> <code>CSS</code> <code>MySQL</code>等事物，也是被当时 <a href=\"https://github.com/DIYgod\" target=\"_blank\">DIYgod</a> 的 WordPress 主题 Amativeness 所吸引，让我逐渐在后续的时间开始了学习，这些在<a href=\"/the-story-of-anya\">「名为『Hexo-Theme-Anya』的故事」</a>一文中有详细描述，此处不作赘述。</p>\n<h3 id=\"hexo\">Hexo<a title=\"#hexo\" href=\"#hexo\"></a></h3>\n<p><img src=\"https://img.xiangnorth.com/2022/07/W0LtZ0.png\" alt=\"Hexo\" loading=\"lazy\" class=\"φbp\"></p>\n<p>最后归宿来到了 <a href=\"https://hexo.io\" target=\"_blank\">Hexo</a>，是一个非常「简单」的博客框架。</p>\n<p>接触到 Hexo 是因为接触到了 GitHub，与 WordPress 作为动态网站，需要一系列后端支撑不同，静态网站能够不用花费那么多心思就能将博客稳定搭建到 GitHub Pages，Vercel 等静态站点托管平台甚至是静态资源加速 CDN 上，让我轻松了不少。</p>\n<p><strong>本篇文章写作时</strong>，博客便是搭建在在 Hexo 上。</p>\n<h2 id=\"main\">Main<a title=\"#main\" href=\"#main\"></a></h2>\n<p>我的博客是一个静态网站，<strong>没有动态，没有 API，没有管理后台，没有任何的动态更新</strong>，只有一个静态页面。</p>\n<p>她由 Hexo 驱动，样式由 <a href=\"https://github.com/ikeq/hexo-theme-inside\" target=\"_blank\">Inside</a> 提供，部署于 <a href=\"https://vercel.com/\" target=\"_blank\">Vercel</a> 平台，部分静态文件由 <a href=\"https://www.jsdelivr.com\" target=\"_blank\">jsDelivr</a> 提供 CDN 加速。</p>\n<h3 id=\"ci/cd\">CI/CD<a title=\"#ci/cd\" href=\"#ci/cd\"></a></h3>\n<blockquote><p>在软件工程中，CI/CD 或 CICD 通常指的是持续集成和持续交付或持续部署的组合实践。CI/CD 通过在应用程序的构建、测试和部署中实施自动化，在开发和运营团队之间架起了桥梁。</p>\n<footer><strong>Wikipedia</strong><cite><a href=\"https://zh.wikipedia.org/wiki/CI/CD\">CI/CD</a></cite></footer></blockquote>\n<p>在这里，主要是介绍 <a href=\"https://github.com/features/actions\" target=\"_blank\">GitHub Actions</a> 在部署我的博客中的使用，<strong>不会</strong>涉及 Hexo 怎么配置，怎么上传到。</p>\n<figure class=\"highlight yaml\"><figcaption><span>main.yml</span><a href=\"https://github.com/XiangNorth/XiangNorth.com/blob/main/.github/workflows/main.yml\">workflows/main.yml</a></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">name:</span> <span class=\"string\">Blog</span> <span class=\"string\">CI/CD</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">on:</span> [<span class=\"string\">push</span>, <span class=\"string\">repository_dispatch</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">jobs:</span></span><br><span class=\"line\"><span class=\"attr\">blog-cicd:</span></span><br><span class=\"line\"><span class=\"attr\">name:</span> <span class=\"string\">Hexo</span> <span class=\"string\">blog</span> <span class=\"string\">build</span> <span class=\"string\">&amp;</span> <span class=\"string\">deploy</span></span><br><span class=\"line\"><span class=\"attr\">runs-on:</span> <span class=\"string\">ubuntu-latest</span></span><br><span class=\"line\"><span class=\"attr\">env:</span></span><br><span class=\"line\"><span class=\"attr\">TZ:</span> <span class=\"string\">Asia/Shanghai</span></span><br><span class=\"line\"><span class=\"attr\">steps: - name:</span> <span class=\"string\">Checkout</span> <span class=\"string\">codes</span></span><br><span class=\"line\"><span class=\"attr\">uses:</span> <span class=\"string\">actions/checkout@v2</span></span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Setup</span> <span class=\"string\">node</span></span><br><span class=\"line\">        <span class=\"attr\">uses:</span> <span class=\"string\">actions/setup-node@v1</span></span><br><span class=\"line\">        <span class=\"attr\">with:</span></span><br><span class=\"line\">          <span class=\"attr\">node-version:</span> <span class=\"string\">&quot;16.x&quot;</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Cache</span> <span class=\"string\">node</span> <span class=\"string\">modules</span></span><br><span class=\"line\">        <span class=\"attr\">uses:</span> <span class=\"string\">actions/cache@v1</span></span><br><span class=\"line\">        <span class=\"attr\">with:</span></span><br><span class=\"line\">          <span class=\"attr\">path:</span> <span class=\"string\">~/.npm</span></span><br><span class=\"line\">          <span class=\"attr\">key:</span> <span class=\"string\">$&#123;&#123;</span> <span class=\"string\">runner.os</span> <span class=\"string\">&#125;&#125;`-node-$&#123;&#123;</span> <span class=\"string\">hashFiles(&#x27;**/package-lock.json&#x27;)</span> <span class=\"string\">&#125;&#125;</span></span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Install</span> <span class=\"string\">dependencies</span></span><br><span class=\"line\">        <span class=\"attr\">run:</span> <span class=\"string\">|</span></span><br><span class=\"line\"><span class=\"string\">          npm install hexo-cli -g</span></span><br><span class=\"line\"><span class=\"string\">          npm install</span></span><br><span class=\"line\"><span class=\"string\"></span>      <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Generate</span> <span class=\"string\">files</span></span><br><span class=\"line\">        <span class=\"attr\">run:</span> <span class=\"string\">hexo</span> <span class=\"string\">generate</span></span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Deploy</span> <span class=\"string\">blog</span></span><br><span class=\"line\">        <span class=\"attr\">run:</span> <span class=\"string\">|</span></span><br><span class=\"line\"><span class=\"string\">          git clone -b blog &quot;https://$&#123;&#123; secrets.GH_REF &#125;&#125;&quot; deploy_git</span></span><br><span class=\"line\"><span class=\"string\">          mv ./deploy_git/.git ./public/</span></span><br><span class=\"line\"><span class=\"string\">          cd ./public</span></span><br><span class=\"line\"><span class=\"string\">          git config user.name &quot;XiangNorth&quot;</span></span><br><span class=\"line\"><span class=\"string\">          git config user.email &quot;i@xiangnorth.com&quot;</span></span><br><span class=\"line\"><span class=\"string\">          git add .</span></span><br><span class=\"line\"><span class=\"string\">          git commit -m &quot;GitHub Actions Auto Builder at $(date +&#x27;%Y-%m-%d %H:%M:%S&#x27;)&quot;</span></span><br><span class=\"line\"><span class=\"string\">          git push --force --quiet &quot;https://XiangNorth:$&#123;&#123; secrets.GITHUB_TOKEN &#125;&#125;@$&#123;&#123; secrets.GH_REF &#125;&#125;&quot; blog:blog</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br></pre></td></tr></table></figure>\n<p>为了方便并「优雅」地部署，我使用了 <code>secrets.GITHUB_TOKEN</code> 来代替 GitHub 的 API Token，你可以在 <a href=\"https://docs.github.com/en/actions/security-guides/automatic-token-authentication\" target=\"_blank\">这篇文档</a> 了解更多。</p>\n<p>原理是就是简单的，当「push」，或者手动触发——即「dispatch」——时，就会触发这个 CI/CD 进程：</p>\n<div class=\"φbt\"><ul>\n<li>检查并配置环境</li>\n<li>运行 <code>hexo generate</code></li>\n<li>将生成的 <code>public</code> 目录通过自动生成的 <code>secrets.GITHUB_TOKEN</code> push 到 <code>blog</code> 分支</li>\n<li>这时 Vercel 就会监听到并自动将该分支最新内容进行部署</li>\n</ul>\n</div><h3 id=\"editing\">Editing<a title=\"#editing\" href=\"#editing\"></a></h3>\n<h4 id=\"words\">Words<a title=\"#words\" href=\"#words\"></a></h4>\n<p><img src=\"https://img.xiangnorth.com/2022/07/N8Ap28.png\" alt=\"VS Code\" loading=\"lazy\" class=\"φbp\"></p>\n<p>得益于 VS Code 强大的拓展性，我可以轻松地在其中进行 Markdown 的写作的同时进行预览。</p>\n<p>更有「markdownlint」、「GitHub Copilot」等插件帮助我写出更好的风格<s>以缓解强迫症</s>，或是自动联想出各种词条。</p>\n<h4 id=\"images\">Images<a title=\"#images\" href=\"#images\"></a></h4>\n<p>我的博客文章图片的解决方案是「GitHub」+「jsDelivr CDN」，即将图片上传至我的图片专用仓库，然后通过 jsDelivr CDN 加载。</p>\n<p><img src=\"https://img.xiangnorth.com/2022/07/z5qMXT.png\" alt=\"uPic\" loading=\"lazy\" class=\"φbp\"></p>\n<p>我使用的上传工具为「uPic」, 它是一款开源的 macOS 软件，你可以去他的 <a href=\"https://github.com/gee1k/uPic\" target=\"_blank\">GitHub 主页</a> 开始使用或支持开发者。</p>\n<h3 id=\"inspiration\">Inspiration<a title=\"#inspiration\" href=\"#inspiration\"></a></h3>\n<p>如何获取写作灵感，我使用了两种方式：</p>\n<ul>\n<li>通过不断经历获得感悟（学习、生活、工作）</li>\n<li>通过阅读更多的<strong>原创文章</strong>，吸收其中的能量</li>\n</ul>\n<p>关于阅读原创文章，我更多是通过 RSS 订阅<a href=\"https://github.com/timqian/chinese-independent-blogs\" target=\"_blank\">「中文独立博客列表」</a>进行充能，如果您有兴趣也可以参考一份，也欢迎订阅 <a href=\"https://xiangnorth.com/atom.xml\" target=\"_blank\">本站的 RSS</a>。</p>\n<p>也欢迎大家在这个被各种算法推荐流充斥的时代，尝试 RSS 这个稍显「落后」的阅读方式。</p>\n<h2 id=\"epilogue\">Epilogue<a title=\"#epilogue\" href=\"#epilogue\"></a></h2>\n<p>最近正在学习 React，重构博客的想法也随着再次冒了出来。</p>\n<p>在平时的阅读中也见过很多大佬或漂亮或优雅的页面，如<a href=\"https://tobiasahlin.com/blog/\" target=\"_blank\">「Tobias Ahlin」</a>和<a href=\"https://www.joshwcomeau.com/\" target=\"_blank\">「Josh W Comeau」</a>。</p>\n<p><img src=\"https://img.xiangnorth.com/2022/07/EOkAE2.png\" alt=\"Tobias Ahlin\" loading=\"lazy\" class=\"φbp\"></p>\n<p><img src=\"https://img.xiangnorth.com/2022/07/qInlvc.png\" alt=\"Josh W Comeau\" loading=\"lazy\" class=\"φbp\"></p>\n<p>总之岁月静好，还有很多时间，我们慢慢来。</p>\n","next":{"title":"名为「Hexo-Theme-Anya」的故事","link":"the-story-of-anya"},"plink":"https://xiangnorth.com/how-i-publish-blog/","toc":[{"id":"prologue","title":"Prologue","index":"1","children":[{"id":"lofter","title":"Lofter","index":"1.1"},{"id":"wordpress","title":"WordPress","index":"1.2"},{"id":"hexo","title":"Hexo","index":"1.3"}]},{"id":"main","title":"Main","index":"2","children":[{"id":"ci/cd","title":"CI&#x2F;CD","index":"2.1"},{"id":"editing","title":"Editing","index":"2.2"},{"id":"inspiration","title":"Inspiration","index":"2.3"}]},{"id":"epilogue","title":"Epilogue","index":"3"}],"reward":true,"copyright":{"license":"<a href=\"https://creativecommons.org/licenses/by-nc-sa/4.0/\" rel=\"external nofollow\" target= \"_blank\">CC BY-NC-ND 4.0</a>","link":"<a href=\"https://xiangnorth.com/how-i-publish-blog/\" title=\"我是如何发表博客的\">https://xiangnorth.com/how-i-publish-blog/</a>","published":"July 11, 2022","updated":"July 13, 2022"},"reading_time":"1402 words in 9 min"}